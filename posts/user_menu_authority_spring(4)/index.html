<!DOCTYPE html><html lang="ko-KR" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="google-site-verification" content="YBUeGcldgKfDGh7GNEfhp9jWiJV6ASO69OZy4QbOTJg" /><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="관리자 권한, 메뉴 관리 (5)" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="user_menu_authority" /><meta property="og:description" content="user_menu_authority" /><link rel="canonical" href="https://angrypig123.github.io/posts/user_menu_authority_spring(4)/" /><meta property="og:url" content="https://angrypig123.github.io/posts/user_menu_authority_spring(4)/" /><meta property="og:site_name" content="화난돼지 블로그" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-06-08T21:30:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="관리자 권한, 메뉴 관리 (5)" /><meta name="twitter:site" content="@Angrypig123" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-06-08T21:30:00+09:00","datePublished":"2024-06-08T21:30:00+09:00","description":"user_menu_authority","headline":"관리자 권한, 메뉴 관리 (5)","mainEntityOfPage":{"@type":"WebPage","@id":"https://angrypig123.github.io/posts/user_menu_authority_spring(4)/"},"url":"https://angrypig123.github.io/posts/user_menu_authority_spring(4)/"}</script><title>관리자 권한, 메뉴 관리 (5) | 화난돼지 블로그</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="화난돼지 블로그"><meta name="application-name" content="화난돼지 블로그"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://github.com/AngryPig123/angrypig123.github.io/assets/86225268/60c8eac8-a33e-455d-aae7-c7a72051c2e7" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">화난돼지 블로그</a></div><div class="site-subtitle font-italic">기록용 블로그</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Angrypig123" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Angrypig123" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['shguddnr2','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>관리자 권한, 메뉴 관리 (5)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>관리자 권한, 메뉴 관리 (5)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/AngryPig123">angrypig back-end</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2024-06-08 21:30:00 +0900" data-toggle="tooltip" data-placement="bottom" title="Sat, Jun 8, 2024, 9:30 PM +0900" >Jun 8</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1117 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><p><a href="https://angrypig123.github.io/posts/user_menu_authority_spring(3)/" target="\_blank">user_menu_authority</a></p><p><br /></p><ul><li>이전 포스팅글들에서 구성한 정보를 가지고 어떤 식으로 인가 처리를 하는지에 대해 작성해보려 합니다.<ul><li>실제 코드에서는 <code class="language-plaintext highlighter-rouge">@PreAuthorize</code>, <code class="language-plaintext highlighter-rouge">@PostAuthorize</code>를 이용하여 <code class="language-plaintext highlighter-rouge">authority</code>에 대한 사용자 제한을 구현했습니다.</ul></ul><p><br /></p><h2>테스트 컨트롤러</h2><ul><li>테스트를 위한 컨트롤러입니다. 코드를 보면 알겠지만 <code class="language-plaintext highlighter-rouge">[메뉴명]_[CRUD]</code>와 같은 식으로 접근 권한을 주었습니다.<ul><li><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre><span class="nd">@Slf4j</span>
<span class="nd">@RestController</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/api/menu-access-test"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MenuAccessTestController</span> <span class="o">{</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/adspm-create"</span><span class="o">)</span>
    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasAnyAuthority('ST_ADSPM_CREATE')"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">stAdspmCreate</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"success"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/adspm-read"</span><span class="o">)</span>
    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasAnyAuthority('ST_ADSPM_READ')"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">stAdspmRead</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"success"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/adspm-update"</span><span class="o">)</span>
    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasAnyAuthority('ST_ADSPM_UPDATE')"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">stAdspmUpdate</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"success"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/adspm-delete"</span><span class="o">)</span>
    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasAnyAuthority('ST_ADSPM_DELETE')"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">stAdspmDelete</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"success"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/aspm-create"</span><span class="o">)</span>
    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasAnyAuthority('ST_ASPM_CREATE')"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">stAspmCreate</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"success"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/aspm-read"</span><span class="o">)</span>
    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasAnyAuthority('ST_ASPM_READ')"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">stAspmRead</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"success"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/aspm-update"</span><span class="o">)</span>
    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasAnyAuthority('ST_ASPM_UPDATE')"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">stAspmUpdate</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"success"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/aspm-delete"</span><span class="o">)</span>
    <span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">"hasAnyAuthority('ST_ASPM_DELETE')"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">stAspmDelete</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ResponseEntity</span><span class="o">&lt;&gt;(</span><span class="s">"success"</span><span class="o">,</span> <span class="nc">HttpStatus</span><span class="o">.</span><span class="na">OK</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div></ul></ul><p><br /></p><ul><li><code class="language-plaintext highlighter-rouge">flyway</code>를 이용해 초기에 설정한 메뉴 권한 정보 입니다.<ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_ADA'</span><span class="p">,</span> <span class="s1">'ST_ADSPM_CREATE'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_ADA'</span><span class="p">,</span> <span class="s1">'ST_ADSPM_READ'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_ADA'</span><span class="p">,</span> <span class="s1">'ST_ADSPM_UPDATE'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_ADA'</span><span class="p">,</span> <span class="s1">'ST_ADSPM_DELETE'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_ADA'</span><span class="p">,</span> <span class="s1">'ST_ASPM_CREATE'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_ADA'</span><span class="p">,</span> <span class="s1">'ST_ASPM_READ'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_ADA'</span><span class="p">,</span> <span class="s1">'ST_ASPM_UPDATE'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_ADA'</span><span class="p">,</span> <span class="s1">'ST_ASPM_DELETE'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>


<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_ADSA'</span><span class="p">,</span> <span class="s1">'ST_ADSPM_READ'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_ADSA'</span><span class="p">,</span> <span class="s1">'ST_ASPM_READ'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>


<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_AA'</span><span class="p">,</span> <span class="s1">'ST_ASPM_CREATE'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_AA'</span><span class="p">,</span> <span class="s1">'ST_ASPM_READ'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_AA'</span><span class="p">,</span> <span class="s1">'ST_ASPM_UPDATE'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">user_type_menu_authority</span><span class="p">(</span><span class="n">common_code_id</span><span class="p">,</span> <span class="n">menu_authority_id</span><span class="p">,</span> <span class="n">create_id</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'UT_AA'</span><span class="p">,</span> <span class="s1">'ST_ASPM_DELETE'</span><span class="p">,</span> <span class="s1">'site_admin'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">"user"</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">user_type</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'admin'</span><span class="p">,</span> <span class="s1">'1234'</span><span class="p">,</span> <span class="s1">'UT_ADA'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">"user"</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">user_type</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'sub_admin'</span><span class="p">,</span> <span class="s1">'1234'</span><span class="p">,</span> <span class="s1">'UT_ADSA'</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">"user"</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">user_type</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'affiliate_admin'</span><span class="p">,</span> <span class="s1">'1234'</span><span class="p">,</span> <span class="s1">'UT_AA'</span><span class="p">);</span>
</pre></table></code></div></div></ul></ul><p><br /></p><ul><li>테스트 코드 설정 클래스 입니다. 설명은 생략하겠습니다.<ul><li><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
</pre><td class="rouge-code"><pre><span class="nd">@SpringBootTest</span>
<span class="nd">@AutoConfigureMockMvc</span>
<span class="nd">@ActiveProfiles</span><span class="o">(</span><span class="s">"local"</span><span class="o">)</span>
<span class="nd">@TestMethodOrder</span><span class="o">(</span><span class="nc">MethodOrderer</span><span class="o">.</span><span class="na">OrderAnnotation</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">TestControllerTestBasic</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">protected</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">protected</span> <span class="nc">UserMapper</span> <span class="n">userMapper</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">protected</span> <span class="nc">ObjectMapper</span> <span class="n">objectMapper</span><span class="o">;</span>

    <span class="nd">@MockBean</span>
    <span class="kd">protected</span> <span class="nc">BackOfficeMenuMapper</span> <span class="n">backOfficeMenuMapper</span><span class="o">;</span>

    <span class="kd">protected</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">MAIN_LOG_IN_PAGE</span> <span class="o">=</span> <span class="s">"/auth/loginPage"</span><span class="o">;</span>

    <span class="kd">protected</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">BACK_OFFICE_MENU_MODEL_KEY</span> <span class="o">=</span> <span class="s">"_backOfficeMenuRes"</span><span class="o">;</span>

    <span class="kd">protected</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">ADMIN_USER_ID</span> <span class="o">=</span> <span class="s">"admin"</span><span class="o">;</span>
    <span class="kd">protected</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">ADMIN_PASSWORD</span> <span class="o">=</span> <span class="s">"1234"</span><span class="o">;</span>

    <span class="kd">protected</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">SUB_ADMIN_USER_ID</span> <span class="o">=</span> <span class="s">"sub_admin"</span><span class="o">;</span>
    <span class="kd">protected</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">SUB_ADMIN_PASSWORD</span> <span class="o">=</span> <span class="s">"1234"</span><span class="o">;</span>

    <span class="kd">protected</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">AFFILIATE_ADMIN_USER_ID</span> <span class="o">=</span> <span class="s">"affiliate_admin"</span><span class="o">;</span>
    <span class="kd">protected</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">AFFILIATE_ADMIN_PASSWORD</span> <span class="o">=</span> <span class="s">"1234"</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">protected</span> <span class="nc">AuthenticationManagerBuilder</span> <span class="n">authenticationManagerBuilder</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">PasswordEncoder</span> <span class="n">passwordEncoder</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">DefaultUserService</span> <span class="n">defaultUserService</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">BackOfficeMenuService</span> <span class="n">backOfficeMenuService</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">CacheManager</span> <span class="n">cacheManager</span><span class="o">;</span>

    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">setSecurityContextHolder</span><span class="o">(</span><span class="nc">String</span> <span class="n">userId</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">Authentication</span> <span class="n">authentication</span> <span class="o">=</span> <span class="n">authenticationHelper</span><span class="o">(</span><span class="n">userId</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
        <span class="nc">SecurityContext</span> <span class="n">securityContext</span> <span class="o">=</span> <span class="nc">SecurityContextHolder</span><span class="o">.</span><span class="na">createEmptyContext</span><span class="o">();</span>
        <span class="n">securityContext</span><span class="o">.</span><span class="na">setAuthentication</span><span class="o">(</span><span class="n">authentication</span><span class="o">);</span>
        <span class="nc">SecurityContextHolder</span><span class="o">.</span><span class="na">setContext</span><span class="o">(</span><span class="n">securityContext</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nc">Authentication</span> <span class="nf">authenticationHelper</span><span class="o">(</span><span class="nc">String</span> <span class="n">userId</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">User</span> <span class="n">userDetails</span> <span class="o">=</span> <span class="o">(</span><span class="nc">User</span><span class="o">)</span> <span class="n">defaultUserService</span><span class="o">.</span><span class="na">loadUserByUsername</span><span class="o">(</span><span class="n">userId</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">passwordEncoder</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="n">password</span><span class="o">,</span> <span class="n">userDetails</span><span class="o">.</span><span class="na">getPassword</span><span class="o">()))</span> <span class="o">{</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">BackOfficeMenuRes</span><span class="o">&gt;</span> <span class="n">backOfficeMenuRes</span> <span class="o">=</span> <span class="n">backOfficeMenuService</span><span class="o">.</span><span class="na">backOfficeMenuToBackOfficeMenuRes</span><span class="o">(</span><span class="n">userDetails</span><span class="o">.</span><span class="na">getUserId</span><span class="o">());</span>
            <span class="n">userDetails</span><span class="o">.</span><span class="na">loginUserMenuList</span><span class="o">(</span><span class="n">backOfficeMenuRes</span><span class="o">);</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">UsernamePasswordAuthenticationToken</span><span class="o">(</span><span class="n">userDetails</span><span class="o">,</span> <span class="n">password</span><span class="o">,</span> <span class="n">userDetails</span><span class="o">.</span><span class="na">getAuthorities</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">BadCredentialsException</span><span class="o">(</span><span class="s">"Bad credentials"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">clearSecurityContextHolder</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">SecurityContextHolder</span><span class="o">.</span><span class="na">clearContext</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@BeforeEach</span>
    <span class="kt">void</span> <span class="nf">beforeEach</span><span class="o">(</span><span class="nc">WebApplicationContext</span> <span class="n">wac</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mockMvc</span> <span class="o">=</span> <span class="nc">MockMvcBuilders</span>
                <span class="o">.</span><span class="na">webAppContextSetup</span><span class="o">(</span><span class="n">wac</span><span class="o">)</span>
                <span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">springSecurity</span><span class="o">()).</span><span class="na">build</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@AfterEach</span>
    <span class="kt">void</span> <span class="nf">afterEach</span><span class="o">()</span> <span class="o">{</span>

        <span class="c1">//  security context holder 초기화</span>
        <span class="n">clearSecurityContextHolder</span><span class="o">();</span>

        <span class="c1">//  ehcache 초기화</span>
        <span class="nc">Collection</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">cacheNames</span> <span class="o">=</span> <span class="n">cacheManager</span><span class="o">.</span><span class="na">getCacheNames</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">cacheName</span> <span class="o">:</span> <span class="n">cacheNames</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Cache</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">cacheManager</span><span class="o">.</span><span class="na">getCache</span><span class="o">(</span><span class="n">cacheName</span><span class="o">);</span>
            <span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">cache</span><span class="o">).</span><span class="na">clear</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div></ul></ul><p><br /></p><ul><li>실제 테스트 코드를 실행하는 클래스 입니다. 간단하게 메소드에 선언된 권한, <code class="language-plaintext highlighter-rouge">setSecurityContextHolder()</code>로 설정된 유저의 권한에 맞게 요청에 대한 응답 상태값을 검증하였습니다. 관리자별로 설정한 권한대로 전체 테스트가 잘 통과하는것을 볼 수 있습니다.<ul><li><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">TestControllerTest</span> <span class="kd">extends</span> <span class="nc">TestControllerTestBasic</span> <span class="o">{</span>


    <span class="nd">@Test</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">adminAuthorityTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">setSecurityContextHolder</span><span class="o">(</span><span class="no">ADMIN_USER_ID</span><span class="o">,</span> <span class="no">SUB_ADMIN_PASSWORD</span><span class="o">);</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-create"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-read"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-update"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-delete"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-create"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-read"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-update"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-delete"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">subAdminAuthorityTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">setSecurityContextHolder</span><span class="o">(</span><span class="no">SUB_ADMIN_USER_ID</span><span class="o">,</span> <span class="no">SUB_ADMIN_PASSWORD</span><span class="o">);</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-create"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isForbidden</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-read"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-update"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isForbidden</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-delete"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isForbidden</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-create"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isForbidden</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-read"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-update"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isForbidden</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-delete"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isForbidden</span><span class="o">());</span>

    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@Order</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">affiliateAdminAuthorityTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">setSecurityContextHolder</span><span class="o">(</span><span class="no">AFFILIATE_ADMIN_USER_ID</span><span class="o">,</span> <span class="no">AFFILIATE_ADMIN_PASSWORD</span><span class="o">);</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-create"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isForbidden</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-read"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isForbidden</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-update"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isForbidden</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/adspm-delete"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isForbidden</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-create"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-read"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-update"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/api/menu-access-test/aspm-delete"</span><span class="o">))</span>
                <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">());</span>

    <span class="o">}</span>

<span class="o">}</span>
</pre></table></code></div></div><ul><li><img data-proofer-ignore data-src="https://github.com/AngryPig123/AngryPig123.github.io/assets/86225268/035c8ccf-5d2b-491e-a231-db3c89c71eb4" alt="result" /></ul></ul></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/spring/'>Spring</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/spring-security/" class="post-tag no-text-decoration" >spring security</a> <a href="/tags/method-security/" class="post-tag no-text-decoration" >method security</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=관리자 권한, 메뉴 관리 (5) - 화난돼지 블로그&url=https://angrypig123.github.io/posts/user_menu_authority_spring(4)/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=관리자 권한, 메뉴 관리 (5) - 화난돼지 블로그&u=https://angrypig123.github.io/posts/user_menu_authority_spring(4)/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=관리자 권한, 메뉴 관리 (5) - 화난돼지 블로그&url=https://angrypig123.github.io/posts/user_menu_authority_spring(4)/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo= "AngryPig123/angrypig123.github.io" issue-term="pathname" label="✨Tester✨" theme="github-light" crossorigin="anonymous" async> </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/user_menu_authority_spring(3)/">관리자 권한, 메뉴 관리 (4)</a><li><a href="/posts/user_menu_authority/">관리자 권한, 메뉴 관리 (1)</a><li><a href="/posts/user_menu_authority_spring(1)/">관리자 권한, 메뉴 관리 (2)</a><li><a href="/posts/user_menu_authority_spring(2)/">관리자 권한, 메뉴 관리 (3)</a><li><a href="/posts/3-tier(1)/">3-tier architecture(1)</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/back-end/">back-end</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/data/">data</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/kocw/">kocw</a> <a class="post-tag" href="/tags/jpa/">jpa</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/user_menu_authority_spring(2)/"><div class="card-body"> <em class="timeago small" date="2024-06-08 16:00:00 +0900" >Jun 8</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>관리자 권한, 메뉴 관리 (3)</h3><div class="text-muted small"><p> user_menu_authority 이전에 작성한 구성 정보를 가지고 spring security적용하여 메뉴별 CRUD권한 체크와 로그인 사용자의 접근 가능한 메뉴정보를 가져오는 기능을 작성해 보려 합니다. 이를 통해 가지고 있는 권한에 맞는 메뉴와 CRUD권한별 인가 설정을 할 수 있게 되었습니다. spring security ...</p></div></div></a></div><div class="card"> <a href="/posts/user_menu_authority_spring(3)/"><div class="card-body"> <em class="timeago small" date="2024-06-08 20:00:00 +0900" >Jun 8</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>관리자 권한, 메뉴 관리 (4)</h3><div class="text-muted small"><p> user_menu_authority 이전에 포스팅에서 작성한 UserDetails를 구현한 User엔티티를 AuthenticationProvider에서 어떤 식으로 사용하는지 작성해보려 합니다. AuthenticationProvider에 대한 설명은 생략하겠습니다. 해당 설정으로 기대하는 기능은 로그인한...</p></div></div></a></div><div class="card"> <a href="/posts/junit_mockito_foundation(2)/"><div class="card-body"> <em class="timeago small" date="2024-03-10 13:00:00 +0900" >Mar 10</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Junit, Mockito (2)</h3><div class="text-muted small"><p> 통합 테스트가 아닌 controller layer만 분리하여 테스트 controller layer에서 처리되는 값을 검증하기 위한 테스트 ex ) http status, model, view, response body 등등…. 테스트 컨트롤러 많이 사용되는 요청과 응답을 케이스별로 정리...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/user_menu_authority_spring(3)/" class="btn btn-outline-primary" prompt="Older"><p>관리자 권한, 메뉴 관리 (4)</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/AngryPig123">angrypig back-end</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/back-end/">back-end</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/data/">data</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/kocw/">kocw</a> <a class="post-tag" href="/tags/jpa/">jpa</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-KDXVLQW78W"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KDXVLQW78W'); }); </script>
